# MSG91 Delivery Flow Frontend Plan

1. **Study Current Delivery UI Implementation**
   - Review `frontend/src/pages/delivery/AssignedOrders.js` and supporting hooks to understand existing state management and API calls for pickup, reached-location, delivery, SMEPay, and OTP flows.
   - Inspect `DeliveryDashboard.js`, `OrderPickup.js`, `OrderDelivery.js`, and related context/services to identify reusable logic for the new detailed flow.

2. **Restructure Assigned Orders Screen Layout**
   - Modify `AssignedOrders.js` to introduce two sections: “Assigned Orders” (awaiting acceptance) and “Orders In Transit” (accepted orders progressing through pickup/delivery).
   - Ensure accepted orders automatically move from the assigned list to the in-transit panel, matching the diagram’s behavior and maintaining responsive layout.

3. **Implement Order Detail Panel Workflow**
   - Replace modal-only interactions with a detailed panel/overlay triggered via “View Order Details”, hiding the order ID while showing seller location, seller phone, and buyer address.
   - Add step controls: “Reached Seller Location” → order ID verification input → confirmation state; then “Reached Buyer Location” with conditional branches.
   - For prepaid orders, surface MSG91 OTP entry after “Reached Buyer Location”; for COD orders, show “Generate SMEPay QR” (reuse existing API) and “Payment Collected in Cash” buttons to mark delivery.

4. **Wire Up Actions to Backend Endpoints**
   - Reuse existing API calls (`/pickup`, `/reached-location`, `/deliver`, SMEPay QR, COD cash confirmation) and align new UI steps to these calls.
   - Update local order state, real-time notifications, and toast messaging so the UI reflects status transitions immediately when the backend responds.

5. **Refine UX Details and Testing Hooks**
   - Add back navigation, loading/disabled states, and contextual messaging across all steps (including OTP resend using MSG91 retry endpoint).
   - Hide order IDs from the UI except for the seller verification input, and ensure address / phone number visibility matches requirements.
   - Smoke test the flow with mock data or by stubbing fetch responses to confirm state transitions, button visibility, and error handling behave like the provided diagrams.

